"use strict";function configuradorLocalStorage(e){e.setPrefix("visioApp").setNotify(!0,!0)}function configuradorInterceptores(e){e.interceptors.push(funcionInterceptoraSeguridad)}function funcionInterceptoraSeguridad(e,t,n,r){var i={};return i.request=function(t){if(isLoginRequest(t.url))r.clearAll();else if(!r.get("token")||!r.get("user")){r.clearAll();var n=e.get("$state");n.go("login")}else console.log("setea el token"),t.headers["x-access-token"]=r.get("token"),t.headers.user=r.get("user");return t},i.responseError=function(i){if(!isLoginRequest(i.url)){var s=e.get("$state");i.status===401?(n.mensaje="No hay derecho!!!",r.clearAll(),s.go("login")):i.status===419&&(n.mensaje="Estoy caduco!!!",r.clearAll(),s.go("login"))}return t.reject(i)},i}function isLoginRequest(e){return e==="/api/authentication"||e==="./estados/login/login.html"?!0:!1}function invoicesService(e){this.gettingInvoicePdf=function(){var t={};return t.responseType="arraybuffer",e.get("/api/factura",t)}}angular.module("visioApp",["ui.router","LocalStorageModule","visioComponentes","visioEstados","visioServicios"]),"use strict",angular.module("visioApp").config(function(e){e.state("not-found",{url:"*path",templateUrl:"not-found.html"})}),angular.module("visioApp").run(function(e){e.defaults.headers.appId="visioApp"}),angular.module("visioApp").config(configuradorInterceptores),angular.module("visioApp").config(configuradorLocalStorage),function(){angular.module("visioComponentes",["visioMenu"]).component("visioContenido",{template:"<div ui-view></div>"})}(),function(){function e(e,t){this.soyElEstadoActivo=function(t){return e.is(t)},this.mostrarMenu=function(){return e.is("login")?!1:!0}}angular.module("visioMenu",["ui.router"]).controller("MenuCtrl",e).component("visioMenu",{templateUrl:"./componentes/menu/tpl-menu.html",controller:"MenuCtrl"})}(),function(){angular.module("visioEstados",["login","dashboard"])}(),function(){function e(e,n,r){var i=this;i.usuario={},i.mostrarMenu=!1,t(n),i.entrar=function(){e.doingLogin(i.usuario).then(function(e){i.message="Usuario logueado: "+i.usuario.name,n.set("token",e.data.token),n.set("user",i.usuario.name),r.go("dashboard")}).catch(function(e){i.message=e.data.message})}}function t(e){e.isSupported||console.error("El navegador no soporta local storage")}angular.module("login",["ui.router","LocalStorageModule","visioServicios"]).config(function(e){e.state("login",{url:"",template:"<visio-login></visio-login>"})}).component("visioLogin",{templateUrl:"./estados/login/login.html",controller:e})}(),function(){function e(e,t,n,r,i){var s=this;s.getPdf=function(){n.gettingInvoicePdf().then(function(e){var n=new Blob([e.data],{type:"application/pdf"}),s=URL.createObjectURL(n);r.pdfContent=i.trustAsResourceUrl(s);var o=t.open({animation:!0,templateUrl:"myModalContent.html",controller:"InvoicesModalCtrl",windowClass:"invoices-modal",resolve:{pdfContent:function(){return r.pdfContent}}});o.result.then(function(e){console.log("a1")},function(){console.log("a2")})}).catch(function(e){console.log("Error en getPdf")})}}function t(e,t,n){e.pdfContent=n,e.closeModal=function(){t.close()}}angular.module("dashboard",["ui.router","ui.bootstrap","visioServicios"]).config(function(e){e.state("dashboard",{url:"/dashboard",template:"<visio-dashboard></visio-dashboard>"})}).controller("DashboardCtrl",e).component("visioDashboard",{templateUrl:"./estados/dashboard/dashboard.html",controller:"DashboardCtrl"}),angular.module("dashboard").controller("InvoicesModalCtrl",t)}(),function(){angular.module("visioServicios",["ngResource"])}(),function(){function e(e){this.doingLogin=function(t){return e.post("/api/authentication",t)}}angular.module("visioServicios").service("loginService",e)}(),angular.module("visioServicios").service("invoicesService",invoicesService)